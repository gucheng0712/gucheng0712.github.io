<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1 maximum-scale=1; minimum-scale=1; user-scalable=no;"> <meta name="author" content="ChengGu"> <meta name="baseurl" content=""> <title> Suzuka Site|C# Reflection in Unity </title> <!-- favicon --> <link rel="shortcut icon" href="/static/assets/img/favicon.ico"> <!-- Main CSS --> <link href="/static/assets/app-20180125.min.css" rel="stylesheet"> <link href="/static/css/custom.css" rel="stylesheet"> <!-- Main Scripts --> <script src="/static/assets/app-20180125.min.js"></script> <script src="/static/assets/blog-20180125.min.js"></script> <!-- Google AdSense --> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <script> (adsbygoogle = window.adsbygoogle || []).push({ google_ad_client: "ca-pub-6196184668650108", enable_page_level_ads: true }); </script> </head> <body id="page-top" class="landing-page"> <div class="search-tool" style="position: fixed; top: 0px ; bottom: 0px; left: 0px; right: 0px; opacity: 0.95; background-color: #111111; z-index: 9999; display: none;"> <input type="text" class="form-control search-content" id="search-content" style="position: fixed; top: 60px" placeholder="Search Blog"> <div style="position: fixed; top: 16px; right: 16px; z-index: 9999;"> <img src=" /static/assets/img/search/cb-close.png " id="close-btn" /> </div> </div> <div style="position: fixed; right: 16px; bottom: 20px; z-index: 9999;"> <img src=" /static/assets/img/search/cb-search.png " id="search-btn" title="Double click Ctrl" /> </div> <div class="navbar-wrapper"> <nav class="navbar navbar-default navbar-fixed-top" role="navigation"> <div class="container"> <div class="navbar-header page-scroll"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href=" / ">Suzuka Site</a> </div> <div id="navbar" class="navbar-collapse collapse"> <ul class="nav navbar-nav navbar-right"> <li><a class="page-scroll" href=" blog/ "></a></li> <li> <a class="page-scroll" href="/blog/">Blog</a></li> <li> <a class="page-scroll" href="/unity/">Unity</a></li> <li> <a class="page-scroll" href="/ai/">AI</a></li> <li> <a class="page-scroll" href="/cg/">CG</a></li> <li> <a class="page-scroll" href="/math/">Math</a></li> <li> <a class="page-scroll" href="/data structure/">Data Structure</a></li> <li> <a class="page-scroll" href="/csharp/">C#</a></li> <li> <a class="page-scroll" href="/python/">Python</a></li> <li> <a class="page-scroll" href="/javascript/">JavaScript</a></li> <li> <a class="page-scroll" href="/dev journal/">Dev Journal</a></li> </ul> </div> </div> </nav> </div> <!--<link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css'>--> <!--<link rel="stylesheet" href="static/css/carousel_style.css">--> <!--<script src="static/js/carousel.js"></script>--> <div id="carouselHacked" class="carousel slide carousel-fade" data-ride="carousel"> <div class="carousel-inner" role="listbox"> <div class="item active"> <!-- Set background for slide in css --> <div class="header-back" style="background-image: url(/static/assets/img/landing/header_1.jpg);" title="first banner image"> </div> </div> <div class="item"> <div class="header-back" style="background-image: url(/static/assets/img/landing/header_2.jpg);" title=""> </div> </div> <div class="item"> <div class="header-back" style="background-image: url(/static/assets/img/landing/header_3.jpg);" title="third banner image"> </div> </div> <div class="item"> <div class="header-back" style="background-image: url(/static/assets/img/landing/header_4.jpg);" title="fourth banner image"> </div> </div> <div class="item"> <div class="header-back" style="background-image: url(/static/assets/img/landing/header_5.jpg);" title="fifth banner image"> </div> </div> <div class="item"> <div class="header-back" style="background-image: url(/static/assets/img/landing/header_6.jpg);" title="sixth banner image"> </div> </div> </div> <!-- Controls --> <a class="left carousel-control" href="#carouselHacked" role="button" data-slide="prev"> <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span> <span class="sr-only">Previous</span> </a> <a class="right carousel-control" href="#carouselHacked" role="button" data-slide="next"> <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span> <span class="sr-only">Next</span> </a> </div> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']], processEscapes: true } }); </script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script> <div class="wrapper wrapper-content animated fadeInRight article"> <div class="row"> <div class="col-lg-10 col-lg-offset-1"> <div class="ibox"> <div class="ibox-content"> <div class="pull-right"> <a class="btn btn-white btn-xs" href="/unity">Unity</a> <a class="btn btn-white btn-xs" href="/csharp">Csharp</a> </div> <div class="text-center article-title"> <span class="text-muted"><i class="fa fa-clock-o"></i> 19 Apr 2019</span> <h1> C# Reflection in Unity </h1> </div> <div class="ibox-postpadding"> <h1 id="what-is-reflection"><strong>What is Reflection?</strong></h1> <p><code class="highlighter-rouge">Reflection</code> is an important mechanism in <code class="highlighter-rouge">C#</code> that allows to <code class="highlighter-rouge">get information</code> about the <code class="highlighter-rouge">members</code> and every member’s <code class="highlighter-rouge">type</code>(class, structure, delegate, interface, enum, etc.) from a <code class="highlighter-rouge">program</code> or <code class="highlighter-rouge">assembly</code>(dll, exe) at <code class="highlighter-rouge">runtime</code>.</p> <blockquote> <p><code class="highlighter-rouge">Pros</code>: Reflection improves the <code class="highlighter-rouge">flexibility</code> and <code class="highlighter-rouge">extensibility</code> of the program, <code class="highlighter-rouge">reduces the coupling</code> and <code class="highlighter-rouge">improves the adaptability</code>. It allows programs to create and control objects of any class without hard-coding the target class in advance.</p> </blockquote> <blockquote> <p><code class="highlighter-rouge">Cons</code>: Reflection is very <code class="highlighter-rouge">slow</code>, and make the internal logic of the program more <code class="highlighter-rouge">complex</code>, and hard to <code class="highlighter-rouge">read</code> and <code class="highlighter-rouge">maintain</code>.</p> </blockquote> <hr /> <h1 id="systemtype-class"><strong>System.Type Class</strong></h1> <p>The System.Type class plays a <code class="highlighter-rouge">central role</code> in reflection. It represents the <code class="highlighter-rouge">instance of the target Class</code>, and provides all the methods of <code class="highlighter-rouge">getting the type</code> information from the target class.</p> <h2 id="1-get-a-type-reference-for-a-given-type"><strong>1. Get a Type reference for a given Type</strong></h2> <ol> <li>Using <code class="highlighter-rouge">typeof()</code> operation: <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">Type</span> <span class="n">t</span> <span class="o">=</span> <span class="n">typeof</span><span class="p">(</span><span class="n">string</span><span class="p">);</span>
</code></pre></div> </div> </li> <li>Using <code class="highlighter-rouge">GetType()</code> method: <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">string</span> <span class="n">s</span> <span class="o">=</span> <span class="s">"grayworm"</span><span class="p">;</span>
 <span class="n">Type</span> <span class="n">t</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">GetType</span><span class="p">();</span> 
</code></pre></div> </div> <hr /> </li> </ol> <h2 id="2-type-classs-properties"><strong>2. Type Class’s Properties</strong></h2> <ul> <li><code class="highlighter-rouge">Type.Name:</code> Get the Type’s name</li> <li><code class="highlighter-rouge">FullName:</code> Get full names of the Type(include namespace)</li> <li><code class="highlighter-rouge">Namespace:</code> Get the NameSpace name</li> <li><code class="highlighter-rouge">IsAbstract:</code> Get a bool shows if this type is an abstract type</li> <li><code class="highlighter-rouge">IsArray: </code> Get a bool shows if this type is an array</li> <li><code class="highlighter-rouge">IsClass:</code> Get a bool shows if this type is a class</li> <li><code class="highlighter-rouge">IsEnum:</code> Get a bool shows if this type is an enum</li> <li><code class="highlighter-rouge">IsInterface:</code> Get a bool shows if this type is an interface</li> <li><code class="highlighter-rouge">IsPublic:</code> Get a bool shows if this type is public</li> <li><code class="highlighter-rouge">IsSealed:</code> Get a bool shows if this type is sealed</li> <li><code class="highlighter-rouge">IsValueType:</code> Get a bool shows if this type is value type, if not then it’s reference type</li> </ul> <hr /> <h2 id="3-type-classs-methods"><strong>3. Type Class’s Methods</strong></h2> <blockquote> <p>After <code class="highlighter-rouge">Getting the Type</code> of the Object through the following code:</p> </blockquote> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1">// Create a new instance of the TargetClass</span>
    <span class="n">TargetClass</span> <span class="n">tc</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">TargetClass</span><span class="p">();</span>

    <span class="c1">// Get the type of TargetClass</span>
    <span class="n">Type</span> <span class="n">t</span> <span class="p">=</span> <span class="n">tc</span><span class="p">.</span><span class="nf">GetType</span><span class="p">();</span>
</code></pre></div></div> <blockquote> <p>Then it will be able to call the <code class="highlighter-rouge">Type</code> class’s <code class="highlighter-rouge">methods</code> to get the information.</p> </blockquote> <ul> <li><code class="highlighter-rouge">GetField(), GetFields()：</code> Return a <code class="highlighter-rouge">FieldInfo</code> Type, for getting the class Member variables’ information. <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">// Get the Fields from the TargetClass</span>
  <span class="n">FieldInfo</span><span class="p">[]</span> <span class="n">fis</span> <span class="p">=</span> <span class="n">t</span><span class="p">.</span><span class="nf">GetFields</span><span class="p">();</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="n">FieldInfo</span> <span class="n">fi</span> <span class="k">in</span> <span class="n">fis</span><span class="p">)</span>
  <span class="p">{</span>
      <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="n">fi</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
  <span class="p">}</span> 
</code></pre></div> </div> </li> <li><code class="highlighter-rouge">GetMethod(), GetMethods()：</code> Return a <code class="highlighter-rouge">MethodInfo</code> Type, for getting the methods’ information of the class. <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">// Get the Methods from the TargetClass</span>
  <span class="n">MethodInfo</span><span class="p">[]</span> <span class="n">mis</span> <span class="p">=</span> <span class="n">t</span><span class="p">.</span><span class="nf">GetMethods</span><span class="p">();</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="n">MethodInfo</span> <span class="n">mi</span> <span class="k">in</span> <span class="n">mis</span><span class="p">)</span>
  <span class="p">{</span>
      <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="n">mi</span><span class="p">.</span><span class="n">ReturnType</span> <span class="p">+</span> <span class="s">" "</span> <span class="p">+</span> <span class="n">mi</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
  <span class="p">}</span>
</code></pre></div> </div> </li> <li><code class="highlighter-rouge">GetProperty(), GetProperties()：</code> Return a <code class="highlighter-rouge">PropertyInfo</code> Type, for getting the Properties’ information of the class. <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">// Get the Properties from the TargetClass</span>
  <span class="n">PropertyInfo</span><span class="p">[]</span> <span class="n">pis</span> <span class="p">=</span> <span class="n">t</span><span class="p">.</span><span class="nf">GetProperties</span><span class="p">();</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="n">PropertyInfo</span> <span class="n">pi</span> <span class="k">in</span> <span class="n">pis</span><span class="p">)</span>
  <span class="p">{</span>
      <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="n">pi</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
  <span class="p">}</span>
</code></pre></div> </div> </li> <li><code class="highlighter-rouge">GetConstructor(), GetConstructors()：</code> Return a <code class="highlighter-rouge">ConstructorInfo</code> Type, used for get the class’s Constructors’s information. <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">// Get all the Constructors of the TargetClass</span>
  <span class="n">ConstructorInfo</span><span class="p">[]</span> <span class="n">constructorInfos</span> <span class="p">=</span> <span class="n">t</span><span class="p">.</span><span class="nf">GetConstructors</span><span class="p">();</span>   

  <span class="k">foreach</span> <span class="p">(</span><span class="n">ConstructorInfo</span> <span class="n">info</span> <span class="k">in</span> <span class="n">constructorInfos</span><span class="p">)</span> 
  <span class="p">{</span>
      <span class="c1">// Get all the parameters of the constructor</span>
      <span class="n">ParameterInfo</span><span class="p">[]</span> <span class="n">parameterInfos</span> <span class="p">=</span> <span class="n">info</span><span class="p">.</span><span class="nf">GetParameters</span><span class="p">();</span>    
      <span class="k">foreach</span> <span class="p">(</span><span class="n">ParameterInfo</span> <span class="n">pi</span> <span class="k">in</span> <span class="n">parameterInfos</span><span class="p">)</span>
      <span class="p">{</span>
          <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="n">pi</span><span class="p">.</span><span class="n">ParameterType</span><span class="p">.</span><span class="nf">ToString</span><span class="p">()</span> <span class="p">+</span> <span class="s">" "</span> <span class="p">+</span> <span class="n">pi</span><span class="p">.</span><span class="n">Name</span> <span class="p">+</span> <span class="s">","</span><span class="p">);</span>
      <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div> </div> </li> <li><code class="highlighter-rouge">GetEvent(), GetEvents()：</code> Return a <code class="highlighter-rouge">EventInfo</code> Type, for getting the class’s event’s information. <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">// Get the Events from the TargetClass</span>
  <span class="n">EventInfo</span><span class="p">[]</span> <span class="n">mis</span> <span class="p">=</span> <span class="n">t</span><span class="p">.</span><span class="nf">GetEvents</span><span class="p">();</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="n">EventInfo</span> <span class="n">mi</span> <span class="k">in</span> <span class="n">mis</span><span class="p">)</span>
  <span class="p">{</span>
      <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="n">mi</span><span class="p">.</span><span class="n">EventHandlerType</span> <span class="p">+</span> <span class="s">" "</span> <span class="p">+</span> <span class="n">mi</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
  <span class="p">}</span>
</code></pre></div> </div> </li> <li><code class="highlighter-rouge">GetMember(), GetMembers()：</code> Return a <code class="highlighter-rouge">MemberInfo</code> Type, for getting all the members’s information of this class. <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">// Get the Members from the TargetClass</span>
  <span class="n">MemberInfo</span><span class="p">[]</span> <span class="n">mis</span> <span class="p">=</span> <span class="n">t</span><span class="p">.</span><span class="nf">GetMembers</span><span class="p">();</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="n">MethodInfo</span> <span class="n">mi</span> <span class="k">in</span> <span class="n">mis</span><span class="p">)</span>
  <span class="p">{</span>
      <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="n">mi</span><span class="p">.</span><span class="n">ReturnType</span> <span class="p">+</span> <span class="s">" "</span> <span class="p">+</span> <span class="n">mi</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
  <span class="p">}</span>
</code></pre></div> </div> </li> </ul> <p>For calling these member, using <code class="highlighter-rouge">Type.InvokeMember()</code>, or other class’s(such as FieldInfo, EvenetInfo, PropertyInfo, etc.) <code class="highlighter-rouge">Invoke()</code> functions.</p> <hr /> <h2 id="4-bindingflags"><strong>4. BindingFlags</strong></h2> <p><code class="highlighter-rouge">BindingFlags</code> is to Specify flags that control binding and the way in which the search for members and types is conducted by reflection.</p> <blockquote> <p>Some Common BindingFlags:</p> </blockquote> <ul> <li><code class="highlighter-rouge">BindingFlags.IgnoreCase:</code> Ignore the Case of the member name</li> <li><code class="highlighter-rouge">BindingFlags.DeclaredOnly:</code> Only Accept the members declared in this class not include inherited memebers.</li> <li><code class="highlighter-rouge">BindingFlags.Instance:</code> Only Accept the Instance members</li> <li><code class="highlighter-rouge">BindingFlags.Static:</code> Only Accept the Static members</li> <li><code class="highlighter-rouge">BindingFlags.Public:</code> Only accept the public members</li> <li><code class="highlighter-rouge">BindingFlags.NonPublic:</code> Only accept the nonpublic members</li> </ul> <blockquote> <p><strong>Code example:</strong></p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Here `|` needs to satisify all of these three Flags members will be get</span>
<span class="n">fis</span> <span class="p">=</span> <span class="k">typeof</span><span class="p">(</span><span class="n">TargetClass</span><span class="p">).</span><span class="nf">GetFields</span><span class="p">(</span><span class="n">BindingFlags</span><span class="p">.</span><span class="n">NonPublic</span> <span class="p">|</span> <span class="n">BindingFlags</span><span class="p">.</span><span class="n">Public</span> <span class="p">|</span> <span class="n">BindingFlags</span><span class="p">.</span><span class="n">Static</span><span class="p">);</span>
</code></pre></div> </div> </blockquote> <hr /> <h1 id="systemreflectionassembly"><strong>System.Reflection.Assembly</strong></h1> <p>Assembly Class can get <code class="highlighter-rouge">Assembly's information</code>, dynamically <code class="highlighter-rouge">loads</code> the Assembly, and finds <code class="highlighter-rouge">type</code> information in the Assembly and <code class="highlighter-rouge">creates Instance</code> of that type.</p> <hr /> <h2 id="reflection-through-the-name-of-the-assembly"><strong>Reflection through the name of the Assembly</strong></h2> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Assembly</span> <span class="n">ass</span> <span class="p">=</span> <span class="n">Assembly</span><span class="p">.</span><span class="nf">Load</span><span class="p">(</span><span class="s">"ClassLibrary"</span><span class="p">);</span>
<span class="n">Type</span> <span class="n">t</span> <span class="p">=</span> <span class="n">ass</span><span class="p">.</span><span class="nf">GetType</span><span class="p">(</span><span class="s">"ClassLibrary.NewClass"</span><span class="p">);</span>
<span class="kt">object</span> <span class="n">o</span> <span class="p">=</span> <span class="n">Activator</span><span class="p">.</span><span class="nf">CreateInstance</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
<span class="n">MethodInfo</span> <span class="n">mi</span> <span class="p">=</span> <span class="n">t</span><span class="p">.</span><span class="nf">GetMethod</span><span class="p">(</span><span class="s">"show"</span><span class="p">);</span>
<span class="n">mi</span><span class="p">.</span><span class="nf">Invoke</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
</code></pre></div></div> <hr /> <h2 id="reflection-through-dll-file-name"><strong>Reflection through Dll file name</strong></h2> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Assembly</span> <span class="n">assembly</span> <span class="p">=</span> <span class="n">Assembly</span><span class="p">.</span><span class="nf">LoadFrom</span><span class="p">(</span><span class="s">"xxx.dll's path"</span><span class="p">);</span>
    <span class="n">Type</span><span class="p">[]</span> <span class="n">aa</span> <span class="p">=</span> <span class="n">a</span><span class="p">.</span><span class="nf">GetTypes</span><span class="p">();</span>
    <span class="k">foreach</span><span class="p">(</span><span class="n">Type</span> <span class="n">t</span> <span class="k">in</span> <span class="n">aa</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">FullName</span> <span class="p">==</span> <span class="s">"a.b.c"</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">object</span> <span class="n">o</span> <span class="p">=</span> <span class="n">Activator</span><span class="p">.</span><span class="nf">CreateInstance</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div></div> <hr /> <h1 id="purpose-and-usage-of-reflection"><strong>Purpose and Usage of Reflection</strong></h1> <hr /> <h2 id="create-instance-dynamicly"><strong>Create Instance Dynamicly</strong></h2> <p>When we are creating the instance in C# we normally will create the object statically.</p> <blockquote> <p>For example, we have three classes, ClassA, ClassB, ClassC, each of them has a function.</p> </blockquote> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">ClassA</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">FunctionA</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Run Function A"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">ClassB</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">FunctionB</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Run Function B"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">ClassC</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">FunctionC</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Run Function C"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <blockquote> <p>When we want to create certain object through code, we have to use switch case or if statement to make decision and create instance one by one, which is staticly create instance.</p> </blockquote> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">ReflectionExample</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nf">CreateObject</span><span class="p">(</span><span class="s">"A"</span><span class="p">);</span>
        <span class="nf">CreateObject</span><span class="p">(</span><span class="s">"B"</span><span class="p">);</span>
        <span class="nf">CreateObject</span><span class="p">(</span><span class="s">"C"</span><span class="p">);</span>
    <span class="p">}</span>


    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">CreateObject</span><span class="p">(</span><span class="kt">string</span> <span class="n">className</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">switch</span> <span class="p">(</span><span class="n">className</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">case</span> <span class="s">"A"</span><span class="p">:</span>
                <span class="n">ClassA</span> <span class="n">a</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ClassA</span><span class="p">();</span>
                <span class="n">a</span><span class="p">.</span><span class="nf">FunctionA</span><span class="p">();</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s">"B"</span><span class="p">:</span>
                <span class="n">ClassB</span> <span class="n">b</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ClassB</span><span class="p">();</span>
                <span class="n">b</span><span class="p">.</span><span class="nf">FunctionB</span><span class="p">();</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s">"C"</span><span class="p">:</span>
                <span class="n">ClassC</span> <span class="n">c</span><span class="p">=</span> <span class="k">new</span> <span class="nf">ClassC</span><span class="p">();</span>
                <span class="n">c</span><span class="p">.</span><span class="nf">FunctionC</span><span class="p">();</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">default</span><span class="p">:</span>
                <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <blockquote> <p>However, We can use <code class="highlighter-rouge">Reflection</code> to create Object <code class="highlighter-rouge">Dynamicly</code> based on the type’s name:</p> </blockquote> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">namespace</span> <span class="nn">ReflectionDemo</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">ClassA</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">FunctionA</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Run Function A"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">ClassB</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">FunctionB</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Run Function B"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">ClassC</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">FunctionC</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Run Function C"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">ReflectionExample01</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
    <span class="p">{</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="nf">DynamicCreateObject</span><span class="p">(</span><span class="s">"A"</span><span class="p">);</span>
            <span class="nf">DynamicCreateObject</span><span class="p">(</span><span class="s">"B"</span><span class="p">);</span>
            <span class="nf">DynamicCreateObject</span><span class="p">(</span><span class="s">"C"</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">DynamicCreateObject</span><span class="p">(</span><span class="kt">string</span> <span class="n">className</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">fullPathName</span> <span class="p">=</span> <span class="s">"ReflectionDemo.Class"</span> <span class="p">+</span> <span class="n">className</span><span class="p">;</span>
            <span class="n">Type</span> <span class="n">type</span> <span class="p">=</span> <span class="n">Type</span><span class="p">.</span><span class="nf">GetType</span><span class="p">(</span><span class="n">fullPathName</span><span class="p">);</span>

            <span class="kt">var</span> <span class="n">obj</span> <span class="p">=</span> <span class="n">Activator</span><span class="p">.</span><span class="nf">CreateInstance</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>

            <span class="kt">var</span> <span class="n">method</span> <span class="p">=</span> <span class="n">obj</span><span class="p">.</span><span class="nf">GetType</span><span class="p">().</span><span class="nf">GetMethod</span><span class="p">(</span><span class="s">"Function"</span> <span class="p">+</span> <span class="n">className</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">method</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">method</span><span class="p">.</span><span class="nf">Invoke</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div></div> <hr /> <blockquote> <p><strong>End –Cheng Gu</strong></p> </blockquote> </div> <hr> <div class="row"> <div class="col-md-6"> <h5 style="display: inline;">Tags:</h5> <button class="btn btn-white btn-xs" type="button">Unity</button> <button class="btn btn-white btn-xs" type="button">Csharp</button> </div> <div class="col-md-6"> <div class="small text-right"> <div> </div> </div> </div> </div> <br> <div class="row"> <div class="col-lg-12"> <!-- donate --> <br> <!-- share --> <div class="a2a_kit a2a_kit_size_32 a2a_default_style"> <a class="a2a_dd" href="https://www.addtoany.com/share"></a> <a class="a2a_button_facebook"></a> <a class="a2a_button_twitter"></a> <a class="a2a_button_google_plus"></a> <a class="a2a_button_linkedin"></a> <a class="a2a_button_email"></a> <a class="a2a_button_wechat"></a> <a class="a2a_button_sina_weibo"></a> <a class="a2a_button_pocket"></a> </div> <script> var a2a_config = a2a_config || {}; a2a_config.color_main = "D7E5ED"; a2a_config.color_border = "AECADB"; a2a_config.color_link_text = "333333"; a2a_config.color_link_text_hover = "333333"; </script> <script async src="https://static.addtoany.com/menu/page.js"></script> <br> <!-- comment --> </div> </div> </div> </div> </div> </div> </div> <!-- Google analytics --> <!-- GrowingIO --> </body> </html>
